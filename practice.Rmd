---
title: "TIL`r format(Sys.Date(), '%Y%m%d')`"
output: html_document
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
pg <- palmerpenguins::penguins
library(tidyverse)
library(caret)
```

## outlier detection in R

```{r}
df <- data.frame(
  group = rep(LETTERS[1:4], each=25),
  var1 = rnorm(100, 100, 5),
  var2 = rnorm(100, 100, 10),
  var3 = rnorm(100, 100, 15)
); df %>% head
```

### function to check outlier

```{r}
df %>% 
  gather(key = group, value = value) %>% 
  ggplot(aes(group, value)) +
  geom_boxplot()
```


```{r}
is.outlier <- function(x) {
  x < quantile(x, 0.25, na.rm = T) - 1*IQR(x, na.rm = T) |
  x > quantile(x, 0.75, na.rm = T) + 1*IQR(x, na.rm = T) 
}
```

```{r}
df %>% 
  gather(key = group, value = value) %>% 
  group_by(group) %>% 
  mutate(is_outlier = is.outlier(value)) %>% 
  filter(is_outlier == T)
  
```

```{r}
airquality %>% 
  pivot_longer(everything(), names_to = "key")
```

```{r}
ggplot2::diamonds %>%      
  mutate(across(.fns = as.character)) %>%     
  pivot_longer(everything(), names_to = "key") %>%     
  arrange(match(key, unique(key))) 
```










