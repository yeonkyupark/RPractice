---
title: "TIL`r format(Sys.Date(), '%Y%m%d')`"
output: html_document
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
pg <- palmerpenguins::penguins
library(tidyverse)
library(caret)
```

## Long format vs. Wide format

### Wide -> Long

```{r}
df <- data.frame(
  col1 = rep(1:5, each=2),
  col2 = 1:10,
  col3 = 11:20,
  col4 = 21:30
); df
```

```{r}
df_mod1 <- reshape2::melt(df, id.vars='col1', 
                  measure.vars=c('col2', 'col3', 'col4')); df_mod1
```

```{r}
df_mod2 <- df %>% 
  gather("col2", "col3", "col4", key = cols, value = value); df_mod2
```

```{r}
df_mod3 <- df %>% 
  pivot_longer(cols = c("col2", "col3", "col4"), names_to = "cols", values_to = "value") %>% 
  arrange(cols); df_mod3
```

# Long -> Wide
col1
variable
value

```{r}
reshape2::dcast(data = df_mod1, formula = col1 ~ variable, sum, value.var = "value")
```


```{r eval=FALSE}
df_mod3 %>% spread( key = cols, value = value)
```

`spread()`는 데이터 중복으로 인해 error 발생

```{r}
df_mod3 %>% 
  pivot_wider(names_from = cols, values_from = value, values_fn = list) %>% 
  unnest(cols = everything())
```

